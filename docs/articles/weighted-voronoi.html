<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Weighted spatial tessellations in constrained domains • weightedVoronoi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Weighted spatial tessellations in constrained domains">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">weightedVoronoi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/weighted-voronoi.html">Weighted spatial tessellations in constrained domains</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/HarriRaven/weightedVoronoi" aria-label="GitHub repository"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Weighted spatial tessellations in constrained domains</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HarriRaven/weightedVoronoi/blob/HEAD/vignettes/weighted-voronoi.Rmd" class="external-link"><code>vignettes/weighted-voronoi.Rmd</code></a></small>
      <div class="d-none name"><code>weighted-voronoi.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://HarriRaven.github.io/weightedVoronoi/">weightedVoronoi</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Spatial allocation around point locations is a recurring requirement
in ecology and social–ecological research, including the delineation of
settlement influence zones, species territories, and management areas.
Voronoi tessellations provide a simple and transparent framework for
dividing space among generators, but standard implementations assume
uniform influence and unconstrained Euclidean distance.</p>
<p>The weightedVoronoi package extends this framework by allowing (i)
generator-specific weights and (ii) tessellations constrained to
arbitrary polygonal domains using either Euclidean or geodesic distance.
This vignette demonstrates the use of the package on a representative
example with a complex domain boundary.</p>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>We first define a concave, irregular spatial domain and a set of
generator points with heterogeneous weights.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://HarriRaven.github.io/weightedVoronoi/">weightedVoronoi</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">crs_use</span> <span class="op">&lt;-</span> <span class="fl">32636</span>  <span class="co"># projected CRS (metres)</span></span>
<span></span>
<span><span class="va">boundary_sf</span> <span class="op">&lt;-</span> <span class="fu">make_irregular_boundary</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html" class="external-link">st_sample</a></span><span class="op">(</span><span class="va">boundary_sf</span>, size <span class="op">=</span> <span class="fl">8</span>, type <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span>
<span><span class="va">points_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span></span>
<span>  village <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  population <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  geometry <span class="op">=</span> <span class="va">pts</span>,</span>
<span>  crs <span class="op">=</span> <span class="va">crs_use</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">boundary_sf</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">points_sf</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="weighted-euclidean-tessellation">Weighted Euclidean tessellation<a class="anchor" aria-label="anchor" href="#weighted-euclidean-tessellation"></a>
</h3>
<p>We first generate a weighted tessellation using Euclidean distance.
Generator influence is scaled using a logarithmic transformation of the
population weights.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_euc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weighted_voronoi_domain.html">weighted_voronoi_domain</a></span><span class="op">(</span></span>
<span>  points_sf <span class="op">=</span> <span class="va">points_sf</span>,</span>
<span>  weight_col <span class="op">=</span> <span class="st">"population"</span>,</span>
<span>  boundary_sf <span class="op">=</span> <span class="va">boundary_sf</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  weight_transform <span class="op">=</span> <span class="va">log10</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  clip_to_boundary <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">boundary_sf</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_euc</span><span class="op">$</span><span class="va">polygons</span><span class="op">[</span><span class="st">"generator_id"</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">points_sf</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="weighted-geodesic-tessellation">Weighted geodesic tessellation<a class="anchor" aria-label="anchor" href="#weighted-geodesic-tessellation"></a>
</h3>
<p>We now generate a tessellation using geodesic distance, in which
distances are constrained to paths entirely within the domain.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_geo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weighted_voronoi_domain.html">weighted_voronoi_domain</a></span><span class="op">(</span></span>
<span>  points_sf <span class="op">=</span> <span class="va">points_sf</span>,</span>
<span>  weight_col <span class="op">=</span> <span class="st">"population"</span>,</span>
<span>  boundary_sf <span class="op">=</span> <span class="va">boundary_sf</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  weight_transform <span class="op">=</span> <span class="va">log10</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"geodesic"</span>,</span>
<span>  close_mask <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  close_iters <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">boundary_sf</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_geo</span><span class="op">$</span><span class="va">polygons</span><span class="op">[</span><span class="st">"generator_id"</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">points_sf</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="geodesic-tessellations-with-elevation-dependent-resistance">Geodesic tessellations with elevation-dependent resistance<a class="anchor" aria-label="anchor" href="#geodesic-tessellations-with-elevation-dependent-resistance"></a>
</h4>
<p>In many ecological and social–ecological applications, effective
distance is shaped not only by domain geometry but also by environmental
resistance. Topography, land cover, or infrastructure may increase the
cost of movement between locations. To accommodate this,
<code>weightedVoronoi</code> allows geodesic distance calculations to be
modified by an isotropic resistance surface.</p>
<p>When a digital elevation model (DEM) is supplied and
<code>use_tobler = TRUE</code>, movement cost is adjusted using Tobler’s
hiking function, which increases effective distance across steep
slopes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://HarriRaven.github.io/weightedVoronoi/">weightedVoronoi</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1) Use a projected CRS (metres)</span></span>
<span><span class="va">crs_use</span> <span class="op">&lt;-</span> <span class="fl">32636</span></span>
<span></span>
<span><span class="co"># 2) Define a rectangular boundary (fast + robust for demos)</span></span>
<span><span class="va">boundary_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span></span>
<span>  geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1200</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1200</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="va">crs_use</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3) Sample generator points INSIDE boundary (guaranteed inside)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n_pts</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html" class="external-link">st_sample</a></span><span class="op">(</span><span class="va">boundary_sf</span>, size <span class="op">=</span> <span class="va">n_pts</span>, type <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">points_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  population <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># skewed weights</span></span>
<span>  geometry <span class="op">=</span> <span class="va">pts</span>,</span>
<span>  crs <span class="op">=</span> <span class="va">crs_use</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sanity check (should be all TRUE)</span></span>
<span><span class="va">inside</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html" class="external-link">st_within</a></span><span class="op">(</span><span class="va">points_sf</span>, <span class="va">boundary_sf</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">inside</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4) Choose resolution (cellsize) — keep consistent everywhere</span></span>
<span><span class="va">cellsize</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">bnd_v</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">boundary_sf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5) Create a synthetic DEM with a strong ridge (easy to see)</span></span>
<span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  ext <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">bnd_v</span><span class="op">)</span>,</span>
<span>  resolution <span class="op">=</span> <span class="va">cellsize</span>,</span>
<span>  crs <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">bnd_v</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="va">dem</span>, df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ridge parameters (tweak height to strengthen/weaken effect)</span></span>
<span><span class="va">y0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">xy</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">xy</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">xy</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">xy</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">14</span></span>
<span><span class="va">height</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">height</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="va">xy</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">y0</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Optional plot check</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">boundary_sf</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, main <span class="op">=</span> <span class="st">"Demo inputs"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">points_sf</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">out_geo_plain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weighted_voronoi_domain.html">weighted_voronoi_domain</a></span><span class="op">(</span></span>
<span>  points_sf <span class="op">=</span> <span class="va">points_sf</span>,</span>
<span>  weight_col <span class="op">=</span> <span class="st">"population"</span>,</span>
<span>  boundary_sf <span class="op">=</span> <span class="va">boundary_sf</span>,</span>
<span>  res <span class="op">=</span> <span class="va">cellsize</span>,</span>
<span>  weight_transform <span class="op">=</span> <span class="va">log10</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"geodesic"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">out_geo_dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weighted_voronoi_domain.html">weighted_voronoi_domain</a></span><span class="op">(</span></span>
<span>  points_sf <span class="op">=</span> <span class="va">points_sf</span>,</span>
<span>  weight_col <span class="op">=</span> <span class="st">"population"</span>,</span>
<span>  boundary_sf <span class="op">=</span> <span class="va">boundary_sf</span>,</span>
<span>  res <span class="op">=</span> <span class="va">cellsize</span>,</span>
<span>  weight_transform <span class="op">=</span> <span class="va">log10</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"geodesic"</span>,</span>
<span>  dem_rast <span class="op">=</span> <span class="va">dem</span>,</span>
<span>  use_tobler <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">boundary_sf</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_geo_plain</span><span class="op">$</span><span class="va">polygons</span><span class="op">[</span><span class="st">"generator_id"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Geodesic"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">points_sf</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">boundary_sf</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_geo_dem</span><span class="op">$</span><span class="va">polygons</span><span class="op">[</span><span class="st">"generator_id"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Geodesic + Tobler ridge resistance"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">points_sf</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="comparing-euclidean-and-geodesic-tessellations">Comparing Euclidean and geodesic tessellations<a class="anchor" aria-label="anchor" href="#comparing-euclidean-and-geodesic-tessellations"></a>
</h2>
<p>Although both tessellations fully partition the domain, they differ
in how influence propagates through concave boundaries and narrow
corridors. The Euclidean tessellation allocates regions based on
straight-line distance within the rasterised domain, whereas the
geodesic tessellation respects the domain geometry and prevents
influence across inaccessible areas.</p>
<p>These differences are reflected both visually and in the
generator-level summary tables returned by the software.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_euc</span><span class="op">$</span><span class="va">summary</span></span>
<span><span class="va">out_geo</span><span class="op">$</span><span class="va">summary</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="practical-considerations">Practical considerations<a class="anchor" aria-label="anchor" href="#practical-considerations"></a>
</h2>
<ul>
<li><p>Resolution: Smaller raster cell sizes improve boundary fidelity
but increase computation time.</p></li>
<li><p>Weights: Alternative weight transformations (e.g. square-root or
power-law) can be supplied to reflect different assumptions about
generator influence.</p></li>
<li><p>Distance metric: Geodesic distance is recommended when domain
geometry strongly constrains access or interaction.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette illustrates how weightedVoronoi can be used to generate
reproducible, weighted spatial tessellations that respect complex
boundaries and heterogeneous generator influence. The approach provides
a flexible alternative to standard Voronoi methods in ecological and
social–ecological applications.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Harri Ravenscroft.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
