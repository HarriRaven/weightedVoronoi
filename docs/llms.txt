# weightedVoronoi

![](reference/figures/fig-main.png)

Tools for weighted spatial tessellation using Euclidean and geodesic
distances within constrained polygons. Produces complete, connected
partitions that respect complex boundaries and heterogeneous point
weights.

ğŸŒ Website: <https://HarriRaven.github.io/weightedVoronoi/>

![](reference/figures/animation-euclidean.gif)

## Installation

``` r
install.packages(â€œremotesâ€)

remotes::install_github(â€œHarriRaven/weightedVoronoiâ€)

library(sf) library(weightedVoronoi)
```

### Use a projected CRS (units in metres)

``` r
crs_use \<- 32636
```

### Domain polygon (simple rectangle for speed)

``` r
boundary_sf <- st_sf(
  geometry = st_sfc(
    st_polygon(list(rbind(
      c(0, 0),
      c(1000, 0),
      c(1000, 1000),
      c(0, 1000),
      c(0, 0)
    )))
  ),
  crs = crs_use
)
```

### Generator points with weights

``` r
points_sf <- st_sf(
  village = paste0("V", 1:5),
  population = c(50, 200, 1000, 150, 400),
  geometry = st_sfc(
    st_point(c(200, 200)),
    st_point(c(800, 250)),
    st_point(c(500, 500)),
    st_point(c(250, 800)),
    st_point(c(750, 750))
  ),
  crs = crs_use
)
```

#### Weighted Euclidean tessellation

``` r
out_euc <- weighted_voronoi_domain(
  points_sf = points_sf,
  weight_col = "population",
  boundary_sf = boundary_sf,
  res = 20,
  weight_transform = log10,
  distance = "euclidean",
  verbose = FALSE
)
```

#### Weighted geodesic tessellation (domain-constrained shortest path distance)

``` r
out_geo <- weighted_voronoi_domain(
  points_sf = points_sf,
  weight_col = "population",
  boundary_sf = boundary_sf,
  res = 20,
  weight_transform = log10,
  distance = "geodesic",
  close_mask = TRUE,
  close_iters = 1,
  verbose = FALSE
)
```

##### Terrain-aware tessellations

`weightedVoronoi` supports geodesic tessellations that incorporate
environmental resistance. When supplied with an elevation raster,
distances are modified using Toblerâ€™s hiking function, allowing
topography to influence spatial allocation.

###### Flat domain (no resistance)

![](reference/figures/fig-flat-3d.png)

###### Elevation-dependent resistance

![](reference/figures/fig-dem-3d.png)

### Inspect outputs

``` r
names(out_euc)

head(out_euc$summary)

out_euc$diagnostics
```

# Outputs

weighted_voronoi_domain() returns:

- polygons: sf object with one polygon per generator (and attributes)

- allocation: terra::SpatRaster assigning each raster cell to a
  generator

- summary: generator-level summary table (area, share, weights, etc.)

- diagnostics: diagnostics and settings (coverage, unreachable fraction
  for geodesic, etc.)

# Notes

- Inputs must be in a projected CRS with metric units (e.g.Â metres).

- res controls the raster resolution and therefore the trade-off between
  speed and boundary fidelity.

- Geodesic tessellations are typically slower than Euclidean
  tessellations because shortest-path distances are computed within the
  domain.

Citation

If you use weightedVoronoi, please cite the associated software note.

# Package index

## Main function

- [`weighted_voronoi_domain()`](https://HarriRaven.github.io/weightedVoronoi/reference/weighted_voronoi_domain.md)
  : Weighted tessellation in a constrained polygon domain

## Engines

- [`weighted_voronoi()`](https://HarriRaven.github.io/weightedVoronoi/reference/weighted_voronoi.md)
  : Weighted Euclidean tessellation (core)
- [`weighted_voronoi_geodesic()`](https://HarriRaven.github.io/weightedVoronoi/reference/weighted_voronoi_geodesic.md)
  : Weighted geodesic tessellation (core)

# Articles

### All vignettes

- [Weighted spatial tessellations in constrained
  domains](https://HarriRaven.github.io/weightedVoronoi/articles/weighted-voronoi.md):
